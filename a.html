<!-- 전체 소스 -->
<!DOCTYPE html>

<head>
    <META http-equiv=Content-Type content="text/html; charset=utf-8">
    <style>
        .area {
            width: 500px;
        }
    </style>
    <!-- <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> -->
    <script>
        /*$(document).ready(function() {
                    $('input[name="itemNo"]').on('change', chg_data);
                    $('#sendBtn').on('click', send_data);
        });*/
        window.addEventListener('DOMContentLoaded', function () {
            var chkBoxList = document.querySelectorAll('input[name="itemNo"]');
            for (var chkBox of chkBoxList) {
                chkBox.addEventListener("change", chg_data);
            }

            document.getElementById('sendBtn').addEventListener("click", send_data);
        });

        function chg_data() {
			/* 바닐라js */
            function chg_data() {
                var itemJsonArr = new Array();
                var chkList = document.querySelectorAll('input[name="itemNo"]:checked');
                for (var i = 0; i < chkList.length; i++) {
                    var obj = chkList.item(i);
                    itemJsonArr.push({
                        itemNo: obj.value
                        , itemNm: obj.parentElement.parentElement.querySelector('.item_name').value
                        , itemGrd: obj.parentElement.parentElement.querySelector('.item_grd').value
                    });
                }
                document.getElementById('itemList').value = itemJsonArr;
                if (itemJsonArr.length > 0) {
                    document.getElementById('itemList2').value = JSON.stringify(itemJsonArr);
                } else {
                    document.getElementById('itemList2').value = "";
                }
            }

        }

        function send_data() {
			function send_data() {
                var itemList = JSON.parse(document.getElementById('itemList2').value);
                var html = "<ul>";
                for (var i = 0; i < itemList.length; i++) {
                    var obj = itemList[i];
                    html += "	<li>(" + obj.itemNo + ":" + obj.itemNm + ":" + obj.itemGrd + ")</li>";
                }
                html += "</ul>";

                document.getElementById('chk_items').innerHTML = html;
            }
        }
    </script>
</head>

<body>
    <div class="area">
        <div>
            <table id="listBox">
                <thead>
                    <tr>
                        <th></th>
                        <th scope="col">품목번호</th>
                        <th scope="col">품목명</th>
                        <th scope="col">품목등급</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <input type="checkbox" name="itemNo" value="ITEM001">
                            <input type="hidden" class="item_name" value="품목1">
                            <input type="hidden" class="item_grd" value="A">
                        </td>
                        <td>ITEM001</td>
                        <td>품목1</td>
                        <td>A</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" name="itemNo" value="ITEM002">
                            <input type="hidden" class="item_name" value="품목2">
                            <input type="hidden" class="item_grd" value="S">
                        </td>
                        <td>ITEM002</td>
                        <td>품목2</td>
                        <td>S</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" name="itemNo" value="ITEM003">
                            <input type="hidden" class="item_name" value="품목3">
                            <input type="hidden" class="item_grd" value="B">
                        </td>
                        <td>ITEM003</td>
                        <td>품목3</td>
                        <td>B</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div>
            <input type="text" id="itemList" value="" style="width:500px">
            <input type="text" id="itemList2" value="" style="width:500px">
        </div>
        <div style="width:200px;margin:20px 0 20px 0;">
            <button type="button" id="sendBtn">데이터 전송</button>
        </div>
        <div>
            체크된 품목들 : <div id="chk_items"></div>
        </div>
    </div>
</body>

</html>
